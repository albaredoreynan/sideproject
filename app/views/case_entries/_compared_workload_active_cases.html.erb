<!-- load_case_open_per_year_per_lawyer(lawyer_id, beginning_date, ending_date) -->

<div class="span10">
  <div class="pull-left">
  </div>
</div>
<br/>
<br/>              
<div class="span10">                      
  <table class="table table-striped" id="case_entries" >
      <%  if params[:beginning_date].nil? || params[:beginning_date].empty? 
              @beginning_date = Date.today.at_beginning_of_month
              @ending_date = Date.today
            else 
              @beginning_date = params[:beginning_date]
              @ending_date = params[:ending_date]
            end
        %>
        <tr>
          <td colspan="5">
            <% @arr = Array.new %>
            <% @ids = params[:lawyer_id] %>
            <% @lawyers = Lawyer.where(id: @ids) %>
            <% @lawyers.each do |lawyer| %>
                <% @arr << [lawyer.full_name, compared_load_case_open_per_year_per_lawyer(lawyer.id, @beginning_date, @ending_date)] %>
            <% end %>
            <script>
            $(function () {
                $('#container').highcharts({
                    chart: {
                        type: 'column'
                    },
                    title: {
                        text: 'Lawyers Active Cases'
                    },
                    subtitle: {
                        text: 'Period Covers: <%=raw(@beginning_date)%> - <%=raw(@ending_date)%>'
                    },
                    xAxis: {
                        type: 'category',
                        labels: {
                            rotation: -45,
                            style: {
                                fontSize: '13px',
                                fontFamily: 'Verdana, sans-serif'
                            }
                        }
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Number of Active Cases'
                        }
                    },
                    legend: {
                        enabled: false
                    },
                    tooltip: {
                        pointFormat: 'Lawyers Active Cases: <b>{point.y:.1f}</b>'
                    },
                    series: [{
                        name: 'Lawyers',
                        data: <%= raw(@arr) %>,
                        dataLabels: {
                            enabled: true,
                            rotation: -90,
                            color: '#FFFFFF',
                            align: 'right',
                            x: 4,
                            y: 10,
                            style: {
                                fontSize: '13px',
                                fontFamily: 'Verdana, sans-serif',
                                textShadow: '0 0 3px black'
                            }
                        }
                    }]
                });
            });
            </script>
            <div id="container" style="width: 100%; height: 600px; margin: 0 auto"></div>
          </td>
        </tr>
  </table>
</div>